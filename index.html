<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <title>Xəta Yoxlanışı</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: sans-serif; padding: 20px; background: #eee; }
        .box { background: white; padding: 20px; border-radius: 10px; border: 2px solid #333; }
        .error-box { background: #ffdddd; color: #d8000c; padding: 15px; border: 1px solid #d8000c; margin-top: 20px; display: none; }
        h2 { margin-top: 0; }
    </style>
</head>
<body>

<div class="box">
    <h2>Nostalji Chat - Yoxlama Rejimi</h2>
    <p>Vəziyyət: <span id="status">Bağlanılır...</span></p>
    <div id="error-log" class="error-box"></div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

    // Xətaları ekrana yazdıran funksiya
    function showError(msg) {
        const errDiv = document.getElementById('error-log');
        const statusSpan = document.getElementById('status');
        errDiv.style.display = 'block';
        errDiv.innerHTML += `<strong>XƏTA:</strong> ${msg}<br><br>`;
        statusSpan.innerText = "Xəta baş verdi!";
        statusSpan.style.color = "red";
    }

    try {
        const firebaseConfig = {
            apiKey: "AIzaSyDbVdZY79YCM_CnpKiMKMRAkTwsqTdcT_pE",
            authDomain: "guestbook-2024.firebaseapp.com",
            projectId: "guestbook-2024",
            storageBucket: "guestbook-2024.firebasestorage.app",
            messagingSenderId: "1033392502453",
            appId: "1:1033392502453:web:f1d8b909b890fd25af30fc",
            databaseURL: "https://guestbook-2024-default-rtdb.firebaseio.com"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const messagesRef = ref(db, 'chat_messages');

        document.getElementById('status').innerText = "Bazaya qoşulur...";

        onValue(messagesRef, (snapshot) => {
            document.getElementById('status').innerText = "Uğurlu! (Data gəldi)";
            document.getElementById('status').style.color = "green";
            alert("Təbriklər! Baza işləyir. İndi əsl kodu qaytara bilərik.");
        }, (error) => {
            console.error(error);
            showError(error.message); // Ekrana xətanı yazır
        });

    } catch (e) {
        showError(e.message);
    }
</script>

</body>
</html>


